import{a as P,b as $,c as J,d as Fe,e as z,f as G,g as X,h as Q,i as je}from"./chunk-MFTKTEFH.js";import{r as Se,t as Te}from"./chunk-JSVRATKM.js";import{Da as _,Ea as ge,Fa as D,La as ve,M as W,Na as ye,O as F,Pa as be,Q as M,R as I,S as me,W as N,Ya as we,Za as ke,a as ce,b as de,bb as Ce,db as R,e as B,ea as O,f as ue,fa as x,ga as S,ha as H,ia as ie,ja as A,ka as fe,lb as q,nb as Ee,ob as xe,qa as re,qb as _e,rb as V,sa as he,x as pe}from"./chunk-VXVQNLGX.js";var Re=B(Fe());(function(){"use strict";try{if(typeof document<"u"){var f=document.createElement("style");f.appendChild(document.createTextNode('.image-tool{--bg-color: #cdd1e0;--front-color: #388ae5;--border-color: #e8e8eb}.image-tool__image{border-radius:3px;overflow:hidden;margin-bottom:10px;padding-bottom:0}.image-tool__image-picture{max-width:100%;vertical-align:bottom;display:block}.image-tool__image-preloader{width:50px;height:50px;border-radius:50%;background-size:cover;margin:auto;position:relative;background-color:var(--bg-color);background-position:center center}.image-tool__image-preloader:after{content:"";position:absolute;z-index:3;width:60px;height:60px;border-radius:50%;border:2px solid var(--bg-color);border-top-color:var(--front-color);left:50%;top:50%;margin-top:-30px;margin-left:-30px;animation:image-preloader-spin 2s infinite linear;box-sizing:border-box}.image-tool__caption{visibility:hidden;position:absolute;bottom:0;left:0;margin-bottom:10px}.image-tool__caption[contentEditable=true][data-placeholder]:before{position:absolute!important;content:attr(data-placeholder);color:#707684;font-weight:400;display:none}.image-tool__caption[contentEditable=true][data-placeholder]:empty:before{display:block}.image-tool__caption[contentEditable=true][data-placeholder]:empty:focus:before{display:none}.image-tool--empty .image-tool__image,.image-tool--empty .image-tool__image-preloader{display:none}.image-tool--empty .image-tool__caption,.image-tool--uploading .image-tool__caption{visibility:hidden!important}.image-tool .cdx-button{display:flex;align-items:center;justify-content:center}.image-tool .cdx-button svg{height:auto;margin:0 6px 0 0}.image-tool--filled .cdx-button,.image-tool--filled .image-tool__image-preloader{display:none}.image-tool--uploading .image-tool__image{min-height:200px;display:flex;border:1px solid var(--border-color);background-color:#fff}.image-tool--uploading .image-tool__image-picture,.image-tool--uploading .cdx-button{display:none}.image-tool--withBorder .image-tool__image{border:1px solid var(--border-color)}.image-tool--withBackground .image-tool__image{padding:15px;background:var(--bg-color)}.image-tool--withBackground .image-tool__image-picture{max-width:60%;margin:0 auto}.image-tool--stretched .image-tool__image-picture{width:100%}.image-tool--caption .image-tool__caption{visibility:visible}.image-tool--caption{padding-bottom:50px}@keyframes image-preloader-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}')),document.head.appendChild(f)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();var We='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19V19C9.13623 19 8.20435 19 7.46927 18.6955C6.48915 18.2895 5.71046 17.5108 5.30448 16.5307C5 15.7956 5 14.8638 5 13V12C5 9.19108 5 7.78661 5.67412 6.77772C5.96596 6.34096 6.34096 5.96596 6.77772 5.67412C7.78661 5 9.19108 5 12 5H13.5C14.8956 5 15.5933 5 16.1611 5.17224C17.4395 5.56004 18.44 6.56046 18.8278 7.83886C19 8.40666 19 9.10444 19 10.5V10.5"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 13V16M16 19V16M19 16H16M16 16H13"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.5 17.5L17.5 6.5"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.9919 10.5H19.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.9919 19H11.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13L13 5"/></svg>',Ne='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.9919 9.5H19.0015"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.5 5H14.5096"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M14.625 5H15C17.2091 5 19 6.79086 19 9V9.375"/><path stroke="currentColor" stroke-width="2" d="M9.375 5L9 5C6.79086 5 5 6.79086 5 9V9.375"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.3725 5H9.38207"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 9.5H5.00957"/><path stroke="currentColor" stroke-width="2" d="M9.375 19H9C6.79086 19 5 17.2091 5 15V14.625"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.3725 19H9.38207"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 14.55H5.00957"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 13V16M16 19V16M19 16H16M16 16H13"/></svg>',Me='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.13968 15.32L8.69058 11.5661C9.02934 11.2036 9.48873 11 9.96774 11C10.4467 11 10.9061 11.2036 11.2449 11.5661L15.3871 16M13.5806 14.0664L15.0132 12.533C15.3519 12.1705 15.8113 11.9668 16.2903 11.9668C16.7693 11.9668 17.2287 12.1705 17.5675 12.533L18.841 13.9634"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.7778 9.33331H13.7867"/></svg>',Ae='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9L20 12L17 15"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 12H20"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 9L4 12L7 15"/><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12H10"/></svg>',qe='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 9V7.2C8 7.08954 8.08954 7 8.2 7L12 7M16 9V7.2C16 7.08954 15.9105 7 15.8 7L12 7M12 7L12 17M12 17H10M12 17H14"/></svg>';function U(f,t=null,e={}){let r=document.createElement(f);Array.isArray(t)?r.classList.add(...t):t!==null&&r.classList.add(t);for(let a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}var K=(f=>(f.Empty="empty",f.Uploading="uploading",f.Filled="filled",f))(K||{}),ae=class{constructor({api:t,config:e,onSelectFile:r,readOnly:a}){this.api=t,this.config=e,this.onSelectFile=r,this.readOnly=a,this.nodes={wrapper:U("div",[this.CSS.baseClass,this.CSS.wrapper]),imageContainer:U("div",[this.CSS.imageContainer]),fileButton:this.createFileButton(),imageEl:void 0,imagePreloader:U("div",this.CSS.imagePreloader),caption:U("div",[this.CSS.input,this.CSS.caption],{contentEditable:!this.readOnly})},this.nodes.caption.dataset.placeholder=this.config.captionPlaceholder,this.nodes.imageContainer.appendChild(this.nodes.imagePreloader),this.nodes.wrapper.appendChild(this.nodes.imageContainer),this.nodes.wrapper.appendChild(this.nodes.caption),this.nodes.wrapper.appendChild(this.nodes.fileButton)}applyTune(t,e){this.nodes.wrapper.classList.toggle(`${this.CSS.wrapper}--${t}`,e)}render(){return this.toggleStatus("empty"),this.nodes.wrapper}showPreloader(t){this.nodes.imagePreloader.style.backgroundImage=`url(${t})`,this.toggleStatus("uploading")}hidePreloader(){this.nodes.imagePreloader.style.backgroundImage="",this.toggleStatus("empty")}fillImage(t){let e=/\.mp4$/.test(t)?"VIDEO":"IMG",r={src:t},a="load";e==="VIDEO"&&(r.autoplay=!0,r.loop=!0,r.muted=!0,r.playsinline=!0,a="loadeddata"),this.nodes.imageEl=U(e,this.CSS.imageEl,r),this.nodes.imageEl.addEventListener(a,()=>{this.toggleStatus("filled"),this.nodes.imagePreloader!==void 0&&(this.nodes.imagePreloader.style.backgroundImage="")}),this.nodes.imageContainer.appendChild(this.nodes.imageEl)}fillCaption(t){this.nodes.caption!==void 0&&(this.nodes.caption.innerHTML=t)}toggleStatus(t){for(let e in K)if(Object.prototype.hasOwnProperty.call(K,e)){let r=K[e];this.nodes.wrapper.classList.toggle(`${this.CSS.wrapper}--${r}`,r===t)}}get CSS(){return{baseClass:this.api.styles.block,loading:this.api.styles.loader,input:this.api.styles.input,button:this.api.styles.button,wrapper:"image-tool",imageContainer:"image-tool__image",imagePreloader:"image-tool__image-preloader",imageEl:"image-tool__image-picture",caption:"image-tool__caption"}}createFileButton(){let t=U("div",[this.CSS.button]);return t.innerHTML=this.config.buttonContent??`${Me} ${this.api.i18n.t("Select an Image")}`,t.addEventListener("click",()=>{this.onSelectFile()}),t}};function Ve(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var Oe={exports:{}};(function(f,t){(function(e,r){f.exports=r()})(window,function(){return function(e){var r={};function a(s){if(r[s])return r[s].exports;var i=r[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=r,a.d=function(s,i,u){a.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:u})},a.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,i){if(1&i&&(s=a(s)),8&i||4&i&&typeof s=="object"&&s&&s.__esModule)return s;var u=Object.create(null);if(a.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:s}),2&i&&typeof s!="string")for(var w in s)a.d(u,w,(function(l){return s[l]}).bind(null,w));return u},a.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(i,"a",i),i},a.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},a.p="",a(a.s=3)}([function(e,r){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}e.exports=a},function(e,r,a){(function(s){var i=a(2),u=setTimeout;function w(){}function l(n){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],o(n,this)}function m(n,c){for(;n._state===3;)n=n._value;n._state!==0?(n._handled=!0,l._immediateFn(function(){var d=n._state===1?c.onFulfilled:c.onRejected;if(d!==null){var v;try{v=d(n._value)}catch(g){return void y(c.promise,g)}p(c.promise,v)}else(n._state===1?p:y)(c.promise,n._value)})):n._deferreds.push(c)}function p(n,c){try{if(c===n)throw new TypeError("A promise cannot be resolved with itself.");if(c&&(typeof c=="object"||typeof c=="function")){var d=c.then;if(c instanceof l)return n._state=3,n._value=c,void b(n);if(typeof d=="function")return void o((v=d,g=c,function(){v.apply(g,arguments)}),n)}n._state=1,n._value=c,b(n)}catch(h){y(n,h)}var v,g}function y(n,c){n._state=2,n._value=c,b(n)}function b(n){n._state===2&&n._deferreds.length===0&&l._immediateFn(function(){n._handled||l._unhandledRejectionFn(n._value)});for(var c=0,d=n._deferreds.length;c<d;c++)m(n,n._deferreds[c]);n._deferreds=null}function k(n,c,d){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof c=="function"?c:null,this.promise=d}function o(n,c){var d=!1;try{n(function(v){d||(d=!0,p(c,v))},function(v){d||(d=!0,y(c,v))})}catch(v){if(d)return;d=!0,y(c,v)}}l.prototype.catch=function(n){return this.then(null,n)},l.prototype.then=function(n,c){var d=new this.constructor(w);return m(this,new k(n,c,d)),d},l.prototype.finally=i.a,l.all=function(n){return new l(function(c,d){if(!n||n.length===void 0)throw new TypeError("Promise.all accepts an array");var v=Array.prototype.slice.call(n);if(v.length===0)return c([]);var g=v.length;function h(j,E){try{if(E&&(typeof E=="object"||typeof E=="function")){var T=E.then;if(typeof T=="function")return void T.call(E,function(oe){h(j,oe)},d)}v[j]=E,--g==0&&c(v)}catch(oe){d(oe)}}for(var C=0;C<v.length;C++)h(C,v[C])})},l.resolve=function(n){return n&&typeof n=="object"&&n.constructor===l?n:new l(function(c){c(n)})},l.reject=function(n){return new l(function(c,d){d(n)})},l.race=function(n){return new l(function(c,d){for(var v=0,g=n.length;v<g;v++)n[v].then(c,d)})},l._immediateFn=typeof s=="function"&&function(n){s(n)}||function(n){u(n,0)},l._unhandledRejectionFn=function(n){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},r.a=l}).call(this,a(5).setImmediate)},function(e,r,a){r.a=function(s){var i=this.constructor;return this.then(function(u){return i.resolve(s()).then(function(){return u})},function(u){return i.resolve(s()).then(function(){return i.reject(u)})})}},function(e,r,a){function s(o){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(o)}a(4);var i,u,w,l,m,p,y,b=a(8),k=(u=function(o){return new Promise(function(n,c){o=l(o),(o=m(o)).beforeSend&&o.beforeSend();var d=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");d.open(o.method,o.url),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(o.headers).forEach(function(g){var h=o.headers[g];d.setRequestHeader(g,h)});var v=o.ratio;d.upload.addEventListener("progress",function(g){var h=Math.round(g.loaded/g.total*100),C=Math.ceil(h*v/100);o.progress(Math.min(C,100))},!1),d.addEventListener("progress",function(g){var h=Math.round(g.loaded/g.total*100),C=Math.ceil(h*(100-v)/100)+v;o.progress(Math.min(C,100))},!1),d.onreadystatechange=function(){if(d.readyState===4){var g=d.response;try{g=JSON.parse(g)}catch{}var h=b.parseHeaders(d.getAllResponseHeaders()),C={body:g,code:d.status,headers:h};y(d.status)?n(C):c(C)}},d.send(o.data)})},w=function(o){return o.method="POST",u(o)},l=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(o.url&&typeof o.url!="string")throw new Error("Url must be a string");if(o.url=o.url||"",o.method&&typeof o.method!="string")throw new Error("`method` must be a string or null");if(o.method=o.method?o.method.toUpperCase():"GET",o.headers&&s(o.headers)!=="object")throw new Error("`headers` must be an object or null");if(o.headers=o.headers||{},o.type&&(typeof o.type!="string"||!Object.values(i).includes(o.type)))throw new Error("`type` must be taken from module's \xABcontentType\xBB library");if(o.progress&&typeof o.progress!="function")throw new Error("`progress` must be a function or null");if(o.progress=o.progress||function(n){},o.beforeSend=o.beforeSend||function(n){},o.ratio&&typeof o.ratio!="number")throw new Error("`ratio` must be a number");if(o.ratio<0||o.ratio>100)throw new Error("`ratio` must be in a 0-100 interval");if(o.ratio=o.ratio||90,o.accept&&typeof o.accept!="string")throw new Error("`accept` must be a string with a list of allowed mime-types");if(o.accept=o.accept||"*/*",o.multiple&&typeof o.multiple!="boolean")throw new Error("`multiple` must be a true or false");if(o.multiple=o.multiple||!1,o.fieldName&&typeof o.fieldName!="string")throw new Error("`fieldName` must be a string");return o.fieldName=o.fieldName||"files",o},m=function(o){switch(o.method){case"GET":var n=p(o.data,i.URLENCODED);delete o.data,o.url=/\?/.test(o.url)?o.url+"&"+n:o.url+"?"+n;break;case"POST":case"PUT":case"DELETE":case"UPDATE":var c=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).type||i.JSON}(o);(b.isFormData(o.data)||b.isFormElement(o.data))&&(c=i.FORM),o.data=p(o.data,c),c!==k.contentType.FORM&&(o.headers["content-type"]=c)}return o},p=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};switch(arguments.length>1?arguments[1]:void 0){case i.URLENCODED:return b.urlEncode(o);case i.JSON:return b.jsonEncode(o);case i.FORM:return b.formEncode(o);default:return o}},y=function(o){return o>=200&&o<300},{contentType:i={URLENCODED:"application/x-www-form-urlencoded; charset=utf-8",FORM:"multipart/form-data",JSON:"application/json; charset=utf-8"},request:u,get:function(o){return o.method="GET",u(o)},post:w,transport:function(o){return o=l(o),b.selectFiles(o).then(function(n){for(var c=new FormData,d=0;d<n.length;d++)c.append(o.fieldName,n[d],n[d].name);b.isObject(o.data)&&Object.keys(o.data).forEach(function(g){var h=o.data[g];c.append(g,h)});var v=o.beforeSend;return o.beforeSend=function(){return v(n)},o.data=c,w(o)})},selectFiles:function(o){return delete(o=l(o)).beforeSend,b.selectFiles(o)}});e.exports=k},function(e,r,a){a.r(r);var s=a(1);window.Promise=window.Promise||s.a},function(e,r,a){(function(s){var i=s!==void 0&&s||typeof self<"u"&&self||window,u=Function.prototype.apply;function w(l,m){this._id=l,this._clearFn=m}r.setTimeout=function(){return new w(u.call(setTimeout,i,arguments),clearTimeout)},r.setInterval=function(){return new w(u.call(setInterval,i,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(l){l&&l.close()},w.prototype.unref=w.prototype.ref=function(){},w.prototype.close=function(){this._clearFn.call(i,this._id)},r.enroll=function(l,m){clearTimeout(l._idleTimeoutId),l._idleTimeout=m},r.unenroll=function(l){clearTimeout(l._idleTimeoutId),l._idleTimeout=-1},r._unrefActive=r.active=function(l){clearTimeout(l._idleTimeoutId);var m=l._idleTimeout;m>=0&&(l._idleTimeoutId=setTimeout(function(){l._onTimeout&&l._onTimeout()},m))},a(6),r.setImmediate=typeof self<"u"&&self.setImmediate||s!==void 0&&s.setImmediate||this&&this.setImmediate,r.clearImmediate=typeof self<"u"&&self.clearImmediate||s!==void 0&&s.clearImmediate||this&&this.clearImmediate}).call(this,a(0))},function(e,r,a){(function(s,i){(function(u,w){if(!u.setImmediate){var l,m,p,y,b,k=1,o={},n=!1,c=u.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(u);d=d&&d.setTimeout?d:u,{}.toString.call(u.process)==="[object process]"?l=function(h){i.nextTick(function(){g(h)})}:function(){if(u.postMessage&&!u.importScripts){var h=!0,C=u.onmessage;return u.onmessage=function(){h=!1},u.postMessage("","*"),u.onmessage=C,h}}()?(y="setImmediate$"+Math.random()+"$",b=function(h){h.source===u&&typeof h.data=="string"&&h.data.indexOf(y)===0&&g(+h.data.slice(y.length))},u.addEventListener?u.addEventListener("message",b,!1):u.attachEvent("onmessage",b),l=function(h){u.postMessage(y+h,"*")}):u.MessageChannel?((p=new MessageChannel).port1.onmessage=function(h){g(h.data)},l=function(h){p.port2.postMessage(h)}):c&&"onreadystatechange"in c.createElement("script")?(m=c.documentElement,l=function(h){var C=c.createElement("script");C.onreadystatechange=function(){g(h),C.onreadystatechange=null,m.removeChild(C),C=null},m.appendChild(C)}):l=function(h){setTimeout(g,0,h)},d.setImmediate=function(h){typeof h!="function"&&(h=new Function(""+h));for(var C=new Array(arguments.length-1),j=0;j<C.length;j++)C[j]=arguments[j+1];var E={callback:h,args:C};return o[k]=E,l(k),k++},d.clearImmediate=v}function v(h){delete o[h]}function g(h){if(n)setTimeout(g,0,h);else{var C=o[h];if(C){n=!0;try{(function(j){var E=j.callback,T=j.args;switch(T.length){case 0:E();break;case 1:E(T[0]);break;case 2:E(T[0],T[1]);break;case 3:E(T[0],T[1],T[2]);break;default:E.apply(w,T)}})(C)}finally{v(h),n=!1}}}}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,a(0),a(7))},function(e,r){var a,s,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function w(){throw new Error("clearTimeout has not been defined")}function l(d){if(a===setTimeout)return setTimeout(d,0);if((a===u||!a)&&setTimeout)return a=setTimeout,setTimeout(d,0);try{return a(d,0)}catch{try{return a.call(null,d,0)}catch{return a.call(this,d,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:u}catch{a=u}try{s=typeof clearTimeout=="function"?clearTimeout:w}catch{s=w}})();var m,p=[],y=!1,b=-1;function k(){y&&m&&(y=!1,m.length?p=m.concat(p):b=-1,p.length&&o())}function o(){if(!y){var d=l(k);y=!0;for(var v=p.length;v;){for(m=p,p=[];++b<v;)m&&m[b].run();b=-1,v=p.length}m=null,y=!1,function(g){if(s===clearTimeout)return clearTimeout(g);if((s===w||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(g);try{s(g)}catch{try{return s.call(null,g)}catch{return s.call(this,g)}}}(d)}}function n(d,v){this.fun=d,this.array=v}function c(){}i.nextTick=function(d){var v=new Array(arguments.length-1);if(arguments.length>1)for(var g=1;g<arguments.length;g++)v[g-1]=arguments[g];p.push(new n(d,v)),p.length!==1||y||l(o)},n.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=c,i.addListener=c,i.once=c,i.off=c,i.removeListener=c,i.removeAllListeners=c,i.emit=c,i.prependListener=c,i.prependOnceListener=c,i.listeners=function(d){return[]},i.binding=function(d){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(d){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,r,a){function s(u,w){for(var l=0;l<w.length;l++){var m=w[l];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(u,m.key,m)}}var i=a(9);e.exports=function(){function u(){(function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")})(this,u)}var w,l,m;return w=u,m=[{key:"urlEncode",value:function(p){return i(p)}},{key:"jsonEncode",value:function(p){return JSON.stringify(p)}},{key:"formEncode",value:function(p){if(this.isFormData(p))return p;if(this.isFormElement(p))return new FormData(p);if(this.isObject(p)){var y=new FormData;return Object.keys(p).forEach(function(b){var k=p[b];y.append(b,k)}),y}throw new Error("`data` must be an instance of Object, FormData or <FORM> HTMLElement")}},{key:"isObject",value:function(p){return Object.prototype.toString.call(p)==="[object Object]"}},{key:"isFormData",value:function(p){return p instanceof FormData}},{key:"isFormElement",value:function(p){return p instanceof HTMLFormElement}},{key:"selectFiles",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(y,b){var k=document.createElement("INPUT");k.type="file",p.multiple&&k.setAttribute("multiple","multiple"),p.accept&&k.setAttribute("accept",p.accept),k.style.display="none",document.body.appendChild(k),k.addEventListener("change",function(o){var n=o.target.files;y(n),document.body.removeChild(k)},!1),k.click()})}},{key:"parseHeaders",value:function(p){var y=p.trim().split(/[\r\n]+/),b={};return y.forEach(function(k){var o=k.split(": "),n=o.shift(),c=o.join(": ");n&&(b[n]=c)}),b}}],(l=null)&&s(w.prototype,l),m&&s(w,m),u}()},function(e,r){var a=function(i){return encodeURIComponent(i).replace(/[!'()*]/g,escape).replace(/%20/g,"+")},s=function(i,u,w,l){return u=u||null,w=w||"&",l=l||null,i?function(m){for(var p=new Array,y=0;y<m.length;y++)m[y]&&p.push(m[y]);return p}(Object.keys(i).map(function(m){var p,y,b=m;if(l&&(b=l+"["+b+"]"),typeof i[m]=="object"&&i[m]!==null)p=s(i[m],null,w,b);else{u&&(y=b,b=!isNaN(parseFloat(y))&&isFinite(y)?u+Number(b):b);var k=i[m];k=(k=(k=(k=k===!0?"1":k)===!1?"0":k)===0?"0":k)||"",p=a(b)+"="+a(k)}return p})).join(w).replace(/[!'()*]/g,""):""};e.exports=s}])})})(Oe);var $e=Oe.exports,L=Ve($e);function ne(f){return f!==void 0&&typeof f.then=="function"}var se=class{constructor({config:t,onUpload:e,onError:r}){this.config=t,this.onUpload=e,this.onError=r}uploadSelectedFile({onPreview:t}){let e=function(a){let s=new FileReader;s.readAsDataURL(a),s.onload=i=>{t(i.target.result)}},r;if(this.config.uploader&&typeof this.config.uploader.uploadByFile=="function"){let a=this.config.uploader.uploadByFile;r=L.selectFiles({accept:this.config.types??"image/*"}).then(s=>{e(s[0]);let i=a(s[0]);return ne(i)||console.warn("Custom uploader method uploadByFile should return a Promise"),i})}else r=L.transport({url:this.config.endpoints.byFile,data:this.config.additionalRequestData,accept:this.config.types??"image/*",headers:this.config.additionalRequestHeaders,beforeSend:a=>{e(a[0])},fieldName:this.config.field??"image"}).then(a=>a.body);r.then(a=>{this.onUpload(a)}).catch(a=>{this.onError(a)})}uploadByUrl(t){let e;this.config.uploader&&typeof this.config.uploader.uploadByUrl=="function"?(e=this.config.uploader.uploadByUrl(t),ne(e)||console.warn("Custom uploader method uploadByUrl should return a Promise")):e=L.post({url:this.config.endpoints.byUrl,data:Object.assign({url:t},this.config.additionalRequestData),type:L.contentType.JSON,headers:this.config.additionalRequestHeaders}).then(r=>r.body),e.then(r=>{this.onUpload(r)}).catch(r=>{this.onError(r)})}uploadByFile(t,{onPreview:e}){let r=new FileReader;r.readAsDataURL(t),r.onload=s=>{e(s.target.result)};let a;if(this.config.uploader&&typeof this.config.uploader.uploadByFile=="function")a=this.config.uploader.uploadByFile(t),ne(a)||console.warn("Custom uploader method uploadByFile should return a Promise");else{let s=new FormData;s.append(this.config.field??"image",t),this.config.additionalRequestData&&Object.keys(this.config.additionalRequestData).length&&Object.entries(this.config.additionalRequestData).forEach(([i,u])=>{s.append(i,u)}),a=L.post({url:this.config.endpoints.byFile,data:s,type:L.contentType.JSON,headers:this.config.additionalRequestHeaders}).then(i=>i.body)}a.then(s=>{this.onUpload(s)}).catch(s=>{this.onError(s)})}};var Y=class f{constructor({data:t,config:e,api:r,readOnly:a,block:s}){this.isCaptionEnabled=null,this.api=r,this.block=s,this.config={endpoints:e.endpoints,additionalRequestData:e.additionalRequestData,additionalRequestHeaders:e.additionalRequestHeaders,field:e.field,types:e.types,captionPlaceholder:this.api.i18n.t(e.captionPlaceholder??"Caption"),buttonContent:e.buttonContent,uploader:e.uploader,actions:e.actions,features:e.features||{}},this.uploader=new se({config:this.config,onUpload:i=>this.onUpload(i),onError:i=>this.uploadingFailed(i)}),this.ui=new ae({api:r,config:this.config,onSelectFile:()=>{this.uploader.uploadSelectedFile({onPreview:i=>{this.ui.showPreloader(i)}})},readOnly:a}),this._data={caption:"",withBorder:!1,withBackground:!1,stretched:!1,file:{url:""}},this.data=t}static get isReadOnlySupported(){return!0}static get toolbox(){return{icon:Me,title:"Image"}}static get tunes(){return[{name:"withBorder",icon:Ne,title:"With border",toggle:!0},{name:"stretched",icon:Ae,title:"Stretch image",toggle:!0},{name:"withBackground",icon:We,title:"With background",toggle:!0}]}render(){var t,e,r;return(((t=this.config.features)==null?void 0:t.caption)===!0||((e=this.config.features)==null?void 0:e.caption)===void 0||((r=this.config.features)==null?void 0:r.caption)==="optional"&&this.data.caption)&&(this.isCaptionEnabled=!0,this.ui.applyTune("caption",!0)),this.ui.render()}validate(t){return!!t.file.url}save(){let t=this.ui.nodes.caption;return this._data.caption=t.innerHTML,this.data}renderSettings(){var t;let e=f.tunes.concat(this.config.actions||[]),r={border:"withBorder",background:"withBackground",stretch:"stretched",caption:"caption"};((t=this.config.features)==null?void 0:t.caption)==="optional"&&e.push({name:"caption",icon:qe,title:"With caption",toggle:!0});let a=e.filter(i=>{var u,w;let l=Object.keys(r).find(m=>r[m]===i.name);return l==="caption"?((u=this.config.features)==null?void 0:u.caption)!==!1:l==null||((w=this.config.features)==null?void 0:w[l])!==!1}),s=i=>{let u=this.data[i.name];return i.name==="caption"&&(u=this.isCaptionEnabled??u),u};return a.map(i=>({icon:i.icon,label:this.api.i18n.t(i.title),name:i.name,toggle:i.toggle,isActive:s(i),onActivate:()=>{if(typeof i.action=="function"){i.action(i.name);return}let u=!s(i);i.name==="caption"&&(this.isCaptionEnabled=!(this.isCaptionEnabled??!1),u=this.isCaptionEnabled),this.tuneToggled(i.name,u)}}))}appendCallback(){this.ui.nodes.fileButton.click()}static get pasteConfig(){return{tags:[{img:{src:!0}}],patterns:{image:/https?:\/\/\S+\.(gif|jpe?g|tiff|png|svg|webp)(\?[a-z0-9=]*)?$/i},files:{mimeTypes:["image/*"]}}}onPaste(t){return ue(this,null,function*(){switch(t.type){case"tag":{let e=t.detail.data;if(/^blob:/.test(e.src)){let r=yield(yield fetch(e.src)).blob();this.uploadFile(r);break}this.uploadUrl(e.src);break}case"pattern":{let e=t.detail.data;this.uploadUrl(e);break}case"file":{let e=t.detail.file;this.uploadFile(e);break}}})}set data(t){var e;this.image=t.file,this._data.caption=t.caption||"",this.ui.fillCaption(this._data.caption),f.tunes.forEach(({name:r})=>{let a=typeof t[r]<"u"?t[r]===!0||t[r]==="true":!1;this.setTune(r,a)}),t.caption?this.setTune("caption",!0):((e=this.config.features)==null?void 0:e.caption)===!0&&this.setTune("caption",!0)}get data(){return this._data}set image(t){this._data.file=t||{url:""},t&&t.url&&this.ui.fillImage(t.url)}onUpload(t){t.success&&t.file?this.image=t.file:this.uploadingFailed("incorrect response: "+JSON.stringify(t))}uploadingFailed(t){console.log("Image Tool: uploading failed because of",t),this.api.notifier.show({message:this.api.i18n.t("Couldn\u2019t upload image. Please try another."),style:"error"}),this.ui.hidePreloader()}tuneToggled(t,e){t==="caption"?(this.ui.applyTune(t,e),e==!1&&(this._data.caption="",this.ui.fillCaption(""))):this.setTune(t,e)}setTune(t,e){this._data[t]=e,this.ui.applyTune(t,e),t==="stretched"&&Promise.resolve().then(()=>{this.block.stretched=e}).catch(r=>{console.error(r)})}uploadFile(t){this.uploader.uploadByFile(t,{onPreview:e=>{this.ui.showPreloader(e)}})}uploadUrl(t){this.ui.showPreloader(t),this.uploader.uploadByUrl(t)}};var Pe=B(je());var Z=class f{constructor(t,e){this.editorServices=t;this.activatedRoute=e}data=null;id;ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{let e=t.get("id");e&&(this.id=e)}),this.fetchWriteup()}fetchWriteup(){this.editorServices.GetById(this.id).subscribe({next:t=>{let e=JSON.parse(t.contentJson);e.title=t.title,this.data=e,setTimeout(()=>this.initializeEditor(),0)},error:t=>console.log(t)})}initializeEditor(){new $({holder:"editor-view",readOnly:!0,data:this.data,tools:{toggle:{class:Pe.default},header:{class:J},code:{class:Re.default},list:{class:z},quote:{class:G},image:{class:Y},delimiter:X,warning:Q}})}static \u0275fac=function(e){return new(e||f)(M(P),M(q))};static \u0275cmp=I({type:f,selectors:[["app-writeup"]],decls:7,vars:1,consts:[[1,"w-screen","min-h-screen","bg-[#121212]","text-white","p-6","font-mono"],[1,"text-4xl","font-extrabold","mb-8","text-[#00ffcc]","border-b-2","border-[#00ffcc]","pb-2","font-sans"],[1,"bg-[#1a1a1a]","p-6","rounded-xl","border","border-[#333]","shadow-lg"],[1,"text-2xl","font-semibold","text-[#00ffcc]","mb-4","font-sans"],["id","editor-view",1,"editorjs-viewer","prose","prose-invert","max-w-none","text-base","leading-7","text-gray-100"]],template:function(e,r){e&1&&(ie(0,"div",0)(1,"h2",1),_(2," \u{1F9E0} CTF Writeup "),A(),ie(3,"div",2)(4,"h3",3),_(5),A(),fe(6,"div",4),A()()),e&2&&(F(5),D(" ",(r.data==null?null:r.data.title)||"Untitled Challenge"," "))},encapsulation:2})};var Ge=f=>["/writeups/writeup",f];function Xe(f,t){if(f&1&&(x(0,"div",4),H(1,"img",5),x(2,"div",6)(3,"h3",7),_(4),S(),x(5,"p",8),_(6),ye(7,"date"),S(),x(8,"a",9),_(9," View Writeup \u2192 "),S()()()),f&2){let e=t.$implicit;F(),O("src",e.imgUrl,W),F(3),ge(e.title||"Untitled Challenge"),F(2),D("\u{1F5D3}\uFE0F ",be(7,4,e.createdAt,"mediumDate")),F(2),O("routerLink",ve(7,Ge,e.id))}}var ee=class f{constructor(t){this.editorServices=t}writeups;ngOnInit(){this.editorServices.Get(0).subscribe({next:t=>{this.writeups=t.map(e=>de(ce({},e),{imgUrl:`${V.baseUrl}/${e.imgUrl}`}))},error:t=>console.log(t)})}static \u0275fac=function(e){return new(e||f)(M(P))};static \u0275cmp=I({type:f,selectors:[["app-Writeups"]],decls:5,vars:1,consts:[[1,"w-screen","min-h-screen","bg-[#121212]","text-white","p-6","font-mono"],[1,"text-4xl","font-extrabold","mb-8","text-[#00ffcc]","border-b-2","border-[#00ffcc]","pb-2","font-sans"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-8"],["class","bg-[#1a1a1a] rounded-xl overflow-hidden shadow-lg border border-[#2a2a2a] hover:shadow-[#00ffcc44] transition-all",4,"ngFor","ngForOf"],[1,"bg-[#1a1a1a]","rounded-xl","overflow-hidden","shadow-lg","border","border-[#2a2a2a]","hover:shadow-[#00ffcc44]","transition-all"],["alt","cover",1,"w-full","h-48","object-cover","border-b","border-[#333]",3,"src"],[1,"p-5","space-y-3"],[1,"text-xl","font-bold","text-[#00ffcc]","truncate"],[1,"text-sm","text-gray-400"],[1,"inline-block","mt-3","text-[#00ffcc]","hover:underline","text-sm",3,"routerLink"]],template:function(e,r){e&1&&(x(0,"div",0)(1,"h2",1),_(2," \u{1F9E0} All CTF Writeups "),S(),x(3,"div",2),N(4,Xe,10,9,"div",3),S()()),e&2&&(F(4),O("ngForOf",r.writeups))},dependencies:[R,we,xe,Ce],encapsulation:2})};var Ue=B(Fe());var Le=B(je());function Qe(f,t){if(f&1&&H(0,"img",10),f&2){let e=he();O("src",e.coverPreview||(e.data==null?null:e.data.imgUrl),W)}}var te=class f{constructor(t,e,r,a){this.editorServices=t;this.activatedRoute=e;this.router=r;this.toastrServiecs=a}data=null;id;editorInstance;coverFile=null;coverPreview=null;ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{let e=t.get("id");e&&(this.id=e,this.fetchWriteup())})}fetchWriteup(){this.editorServices.GetById(this.id).subscribe({next:t=>{let e=JSON.parse(t.contentJson);e.title=t.title,e.imgUrl=`${V.baseUrl}/${t.imgUrl}`,this.data=e,setTimeout(()=>this.initializeEditor(),0)},error:t=>console.log(t)})}initializeEditor(){this.editorInstance=new $({holder:"editor-view",data:this.data,tools:{toggle:{class:Le.default},header:{class:J},code:{class:Ue.default},list:{class:z},quote:{class:G},delimiter:X,warning:Q}})}saveWriteup(){this.editorInstance.save().then(t=>{let e=new FormData;e.append("Id",this.id),e.append("Title",this.data.title),e.append("Blocks",JSON.stringify(t)),e.append("Time",Date.now().toString()),e.append("Version",t.version||"2.29.1"),this.coverFile&&e.append("ImgFile",this.coverFile),this.editorServices.Update(e).subscribe({next:r=>{this.router.navigateByUrl("/dashboard"),this.toastrServiecs.show("update writeUp succesfully")},error:r=>{let a=r.error?.error||"somthing went wrong";this.toastrServiecs.show(a,"error")}})})}onCoverSelected(t){let e=t.target;if(e.files&&e.files[0]){this.coverFile=e.files[0];let r=new FileReader;r.onload=()=>{this.coverPreview=r.result},r.readAsDataURL(this.coverFile)}}static \u0275fac=function(e){return new(e||f)(M(P),M(q),M(Ee),M(Te))};static \u0275cmp=I({type:f,selectors:[["app-updateWriteups"]],decls:15,vars:2,consts:[[1,"w-screen","min-h-screen","bg-[#121212]","text-white","p-6","font-mono"],[1,"text-4xl","font-extrabold","mb-8","text-[#00ffcc]","border-b-2","border-[#00ffcc]","pb-2","font-sans"],[1,"bg-[#1a1a1a]","p-6","rounded-xl","border","border-[#333]","shadow-lg","space-y-6"],[1,"flex","items-center","space-x-4"],["alt","Cover","class","w-20 h-20 rounded-full object-cover border border-gray-600 shadow-md",3,"src",4,"ngIf"],[1,"text-2xl","font-semibold","text-[#00ffcc]","font-sans"],["for","cover",1,"block","text-sm","mb-2","text-gray-300","font-medium"],["type","file","id","cover","accept","image/*",1,"w-full","text-sm","text-gray-300","file:mr-4","file:py-2","file:px-4","file:rounded-lg","file:border-0","file:text-sm","file:font-semibold","file:bg-[#00ffcc]","file:text-black","hover:file:bg-[#00e6b3]","transition",3,"change"],["id","editor-view",1,"editorjs-viewer","max-w-none","text-base","leading-7","text-gray-100","mt-8"],[1,"mt-6","bg-[#00ffcc]","hover:bg-[#00e6b3]","text-black","font-bold","py-2","px-4","rounded-xl","transition-all",3,"click"],["alt","Cover",1,"w-20","h-20","rounded-full","object-cover","border","border-gray-600","shadow-md",3,"src"]],template:function(e,r){e&1&&(x(0,"div",0)(1,"h2",1),_(2," \u{1F9E0} CTF Writeup Editor "),S(),x(3,"div",2)(4,"div",3),N(5,Qe,1,1,"img",4),x(6,"h3",5),_(7),S()(),x(8,"div")(9,"label",6),_(10,"Change Cover Image"),S(),x(11,"input",7),re("change",function(s){return r.onCoverSelected(s)}),S()()(),H(12,"div",8),x(13,"button",9),re("click",function(){return r.saveWriteup()}),_(14," \u{1F4BE} Save Writeup "),S()()),e&2&&(F(5),O("ngIf",r.coverPreview||(r.data==null?null:r.data.imgUrl)),F(2),D(" ",(r.data==null?null:r.data.title)||"Untitled Challenge"," "))},dependencies:[R,ke,Se],encapsulation:2})};var Ke=[{path:"writeup/:id",component:Z},{path:"",component:ee},{path:"updatewriteup/:id",component:te}],He=_e.forChild(Ke);var Be=class f{static \u0275fac=function(e){return new(e||f)};static \u0275mod=me({type:f});static \u0275inj=pe({imports:[R,He]})};export{Be as WriteupModule};
